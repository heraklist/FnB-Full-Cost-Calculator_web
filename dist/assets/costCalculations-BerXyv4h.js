import{p as k,c as x}from"./fixedCosts-Dl8kuOQz.js";const u={kg:{name:"kg",type:"weight",toBase:1,aliases:["kilo","kilos","κιλό"],displayName:"Κιλό"},g:{name:"g",type:"weight",toBase:.001,aliases:["gr","gram","grams","γρ"],displayName:"Γραμμάριο"},mg:{name:"mg",type:"weight",toBase:1e-6,aliases:["milligram"],displayName:"Χιλιοστόγραμμο"},lb:{name:"lb",type:"weight",toBase:.453592,aliases:["lbs","pound","pounds","λίβρα"],displayName:"Λίβρα"},oz:{name:"oz",type:"weight",toBase:.0283495,aliases:["ounce","ounces","ουγγιά"],displayName:"Ουγγιά"},L:{name:"L",type:"volume",toBase:1,aliases:["l","lt","liter","λίτρο"],displayName:"Λίτρο"},ml:{name:"ml",type:"volume",toBase:.001,aliases:["mL","milliliter"],displayName:"Χιλιοστόλιτρο"},cl:{name:"cl",type:"volume",toBase:.01,aliases:["centiliter"],displayName:"Εκατοστόλιτρο"},dl:{name:"dl",type:"volume",toBase:.1,aliases:["deciliter"],displayName:"Δεκατόλιτρο"},gal:{name:"gal",type:"volume",toBase:3.78541,aliases:["gallon","gallons","γαλόνι"],displayName:"Γαλόνι"},qt:{name:"qt",type:"volume",toBase:.946353,aliases:["quart","quarts"],displayName:"Quart"},pt:{name:"pt",type:"volume",toBase:.473176,aliases:["pint","pints"],displayName:"Pint"},cup:{name:"cup",type:"volume",toBase:.236588,aliases:["cups","φλιτζάνι"],displayName:"Φλιτζάνι"},tbsp:{name:"tbsp",type:"volume",toBase:.0147868,aliases:["tbs","tablespoon","κ.σ."],displayName:"Κουταλιά σούπας"},tsp:{name:"tsp",type:"volume",toBase:.00492892,aliases:["teaspoon","κ.γ."],displayName:"Κουταλιά γλυκού"},"fl oz":{name:"fl oz",type:"volume",toBase:.0295735,aliases:["floz","fluid ounce"],displayName:"Fluid ounce"},τεμ:{name:"τεμ",type:"count",toBase:1,aliases:["τεμ.","τεμάχιο","pc","pcs","piece"],displayName:"Τεμάχιο"},pcs:{name:"pcs",type:"count",toBase:1,aliases:["pieces"],displayName:"Pieces"},dozen:{name:"dozen",type:"count",toBase:12,aliases:["dz","ντουζίνα"],displayName:"Ντουζίνα"},φέτα:{name:"φέτα",type:"count",toBase:1,aliases:["φέτες","slice"],displayName:"Φέτα"},σκελίδα:{name:"σκελίδα",type:"count",toBase:1,aliases:["σκελίδες","clove"],displayName:"Σκελίδα"},ματσάκι:{name:"ματσάκι",type:"count",toBase:1,aliases:["bunch"],displayName:"Ματσάκι"}};Object.entries(u).filter(([e,a])=>a.type==="weight").map(([e])=>e);Object.entries(u).filter(([e,a])=>a.type==="volume").map(([e])=>e);Object.entries(u).filter(([e,a])=>a.type==="count").map(([e])=>e);function v(e){var o;if(!e)return e;const a=e.trim();if(u[a])return a;const t=a.toLowerCase();for(const[s,r]of Object.entries(u))if(s.toLowerCase()===t||(o=r.aliases)!=null&&o.some(n=>n.toLowerCase()===t))return s;return a}function B(e,a){const t=v(a),o=u[t];return o?e*o.toBase:e}const w=60,N=100;function z(e){if(!e||!e.fixed_costs_json)return 0;const a=k(e.fixed_costs_json);return x(a)}function M(e,a){let t=0;for(const o of e.ingredients||[]){const s=a.find(r=>r.id===o.ingredient_id);if(s){const r=B(o.quantity,v(o.unit)),n=B(1,v(s.unit)),c=r/n;t+=c*s.price*(1+(s.waste_percent||0)/N)}}return t}function F(e,a,t){if(!t)return{pricePerServing:0,costPerServing:0};const o=M(e,a),s=Math.max(e.servings,1),r=o/s,n=z(t),c=t.mode;if(c==="restaurant"){const p=t.labour_cost_per_hour*e.prep_time_minutes/w,l=Math.max(t.portions_per_month,1),d=(t.overhead_monthly+n)/l*s,i=t.packaging_per_portion*s,_=(o+p+d+i)/s,f=Math.max(t.target_food_cost_percent,1)/N;return{pricePerServing:_/f*(1+t.vat_rate/100),costPerServing:_}}if(c==="catering"){const p=t.disposables_per_person*s,m=(o+p)/s;return{pricePerServing:m*(1+t.catering_markup_percent/100)*(1+t.vat_rate/100),costPerServing:m}}if(c==="private_chef"){const l=e.prep_time_minutes/60*t.chef_fee_per_hour,i=(o*(1+t.food_markup_percent/100)+l)/s;return{pricePerServing:i*(1+t.vat_rate/100),costPerServing:i}}return{pricePerServing:r,costPerServing:r}}function W(e,a,t,o){let s=0,r=0,n=0;for(const f of e.recipes||[]){const g=a.find(b=>b.id===f.recipe_id);if(!g)continue;const h=F(g,t,o),C=f.price_override??h.pricePerServing,P=f.servings||1,S=C*P;s+=S,r+=C,n+=h.costPerServing*P}const c=Math.max(e.guests||1,1),p=o?o.staff_rate_type==="hourly"?(e.staff_count||0)*(e.staff_hours||0)*(o.staff_hourly_rate||0):(e.staff_count||0)*(o.staff_daily_rate||0):0,l=o?(o.transport_cost_per_km||0)*(e.transport_km||0):0,m=e.equipment_cost||0,d=(e.include_staff_in_price?p:0)+l+m,i=(e.pricing_mode==="per_person"?r*c:s)+d,y=i/c,_=i>0?(i-n-p-l-m)/i*100:0;return{total:i,perGuest:y,staffCost:p,transportCost:l,equipmentCost:m,baseTotal:s,costTotal:n,profitMargin:_}}export{W as c,F as g};
