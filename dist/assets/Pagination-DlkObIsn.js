import{R as w,r as p}from"./vendor-react-KfUPlHYY.js";import{u as R,a as z,b as E,j as k}from"./index-D7UZowsJ.js";const M=t=>{let n;const e=new Set,c=(o,l)=>{const d=typeof o=="function"?o(n):o;if(!Object.is(d,n)){const m=n;n=l??(typeof d!="object"||d===null)?d:Object.assign({},n,d),e.forEach(i=>i(n,m))}},r=()=>n,u={setState:c,getState:r,getInitialState:()=>S,subscribe:o=>(e.add(o),()=>e.delete(o))},S=n=t(c,r,u);return u},T=t=>t?M(t):M,D=t=>t;function L(t,n=D){const e=w.useSyncExternalStore(t.subscribe,w.useCallback(()=>n(t.getState()),[t,n]),w.useCallback(()=>n(t.getInitialState()),[t,n]));return w.useDebugValue(e),e}const N=t=>{const n=T(t),e=c=>L(n,c);return Object.assign(e,n),e},V=t=>t?N(t):N,O=V((t,n)=>({undoStack:[],redoStack:[],pendingUndo:null,timeoutId:null,maxHistorySize:50,undoTimeoutMs:1e4,get canUndo(){return n().undoStack.length>0},get canRedo(){return n().redoStack.length>0},pushAction:e=>{const c={...e,id:crypto.randomUUID(),timestamp:Date.now(),undone:!1};t(r=>{r.timeoutId&&clearTimeout(r.timeoutId);const b=[c,...r.undoStack].slice(0,r.maxHistorySize),g=setTimeout(()=>{t({pendingUndo:null,timeoutId:null})},r.undoTimeoutMs);return{undoStack:b,redoStack:[],pendingUndo:c,timeoutId:g}})},undo:()=>{const e=n();if(e.undoStack.length===0)return null;const[c,...r]=e.undoStack;return e.timeoutId&&clearTimeout(e.timeoutId),t({undoStack:r,redoStack:[{...c,undone:!0},...e.redoStack],pendingUndo:null,timeoutId:null}),c},redo:()=>{const e=n();if(e.redoStack.length===0)return null;const[c,...r]=e.redoStack;return t({redoStack:r,undoStack:[{...c,undone:!1},...e.undoStack]}),c},clearPending:()=>{const e=n();e.timeoutId&&clearTimeout(e.timeoutId),t({pendingUndo:null,timeoutId:null})},clearHistory:()=>{const e=n();e.timeoutId&&clearTimeout(e.timeoutId),t({undoStack:[],redoStack:[],pendingUndo:null,timeoutId:null})}}));function F(){const{pushAction:t,undo:n,redo:e,pendingUndo:c,clearPending:r,undoStack:b,redoStack:g}=O(),{createIngredient:u,updateIngredient:S,deleteIngredient:o}=R(),{createRecipe:l,updateRecipe:d,deleteRecipe:m}=z(),{createEvent:i,updateEvent:x,deleteEvent:s}=E(),y=p.useCallback((a,h,v)=>{t({type:"delete",entity:a,data:h,description:`Διαγραφή ${{ingredient:"υλικό",recipe:"συνταγή",event:"event"}[a]} "${v}"`})},[t]),I=p.useCallback((a,h,v)=>{t({type:"update",entity:a,data:h,description:`Τροποποίηση ${{ingredient:"υλικό",recipe:"συνταγή",event:"event"}[a]} "${v}"`})},[t]),j=p.useCallback((a,h,v)=>{t({type:"create",entity:a,data:h,description:`Δημιουργία ${{ingredient:"υλικό",recipe:"συνταγή",event:"event"}[a]} "${v}"`})},[t]),C=p.useCallback(async()=>{const a=n();if(!a)return!1;try{switch(a.type){case"delete":switch(a.entity){case"ingredient":await u(a.data);break;case"recipe":await l(a.data);break;case"event":await i(a.data);break}break;case"update":switch(a.entity){case"ingredient":await S(a.data);break;case"recipe":await d(a.data);break;case"event":await x(a.data);break}break;case"create":switch(a.entity){case"ingredient":await o(a.data.id);break;case"recipe":await m(a.data.id);break;case"event":await s(a.data.id);break}break}return!0}catch(h){return console.error("Undo failed:",h),!1}},[n,u,l,i,S,d,x,o,m,s]),U=p.useCallback(async()=>{const a=e();if(!a)return!1;try{switch(a.type){case"delete":switch(a.entity){case"ingredient":await o(a.data.id);break;case"recipe":await m(a.data.id);break;case"event":await s(a.data.id);break}break;case"update":return!1;case"create":switch(a.entity){case"ingredient":await u(a.data);break;case"recipe":await l(a.data);break;case"event":await i(a.data);break}break}return!0}catch(h){return console.error("Redo failed:",h),!1}},[e,o,m,s,u,l,i]);return{recordDelete:y,recordUpdate:I,recordCreate:j,executeUndo:C,executeRedo:U,pendingUndo:c,clearPending:r,canUndo:b.length>0,canRedo:g.length>0,undoCount:b.length,redoCount:g.length}}function H(t,n={}){const{initialPage:e=1,initialPageSize:c=20,pageSizeOptions:r=[10,20,50,100]}=n,[b,g]=p.useState(e),[u,S]=p.useState(()=>{const f=localStorage.getItem("fnb_page_size");return f?parseInt(f,10):c}),o=t.length,l=Math.max(1,Math.ceil(o/u)),d=Math.min(Math.max(1,b),l);d!==b&&g(d);const m=(d-1)*u,i=Math.min(m+u,o),x=p.useMemo(()=>t.slice(m,i),[t,m,i]),s=p.useCallback(f=>{const $=Math.min(Math.max(1,f),l);g($)},[l]),y=p.useCallback(()=>{s(b+1)},[b,s]),I=p.useCallback(()=>{s(b-1)},[b,s]),j=p.useCallback(()=>{s(1)},[s]),C=p.useCallback(()=>{s(l)},[s,l]),U=p.useCallback(f=>{S(f),g(1),localStorage.setItem("fnb_page_size",String(f))},[]),a=d===1,h=d===l,v=o===0?"Κανένα αποτέλεσμα":`${m+1}-${i} από ${o}`;return{currentPageData:x,currentPage:d,pageSize:u,totalPages:l,totalItems:o,goToPage:s,nextPage:y,prevPage:I,firstPage:j,lastPage:C,setPageSize:U,pageSizeOptions:r,isFirstPage:a,isLastPage:h,startIndex:m,endIndex:i,rangeDisplay:v}}const P=p.memo(function({currentPage:n,totalPages:e,pageSize:c,pageSizeOptions:r,rangeDisplay:b,isFirstPage:g,isLastPage:u,onPageChange:S,onPageSizeChange:o,showPageSize:l=!0,showRange:d=!0}){const m=()=>{const i=[];if(e<=7)for(let s=1;s<=e;s++)i.push(s);else{i.push(1);let s=Math.max(2,n-1),y=Math.min(e-1,n+1);n<=3&&(y=Math.min(e-1,5)),n>=e-2&&(s=Math.max(2,e-5+1)),s>2&&i.push("ellipsis");for(let I=s;I<=y;I++)i.push(I);y<e-1&&i.push("ellipsis"),i.push(e)}return i};return e<=1&&!d?null:k.jsxs("div",{className:"pagination",children:[d&&k.jsx("span",{className:"pagination-range",children:b}),l&&k.jsxs("div",{className:"pagination-size",children:[k.jsx("label",{htmlFor:"pageSize",children:"Ανά σελίδα:"}),k.jsx("select",{id:"pageSize",value:c,onChange:i=>o(Number(i.target.value)),className:"px-2 py-2 rounded border border-divider bg-surface text-primary-900 transition-all focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary",children:r.map(i=>k.jsx("option",{value:i,children:i},i))})]}),e>1&&k.jsxs("div",{className:"pagination-nav",children:[k.jsx("button",{className:"pagination-btn",onClick:()=>S(1),disabled:g,title:"Πρώτη σελίδα",children:"⏮️"}),k.jsx("button",{className:"pagination-btn",onClick:()=>S(n-1),disabled:g,title:"Προηγούμενη",children:"◀️"}),k.jsx("div",{className:"pagination-pages",children:m().map((i,x)=>i==="ellipsis"?k.jsx("span",{className:"pagination-ellipsis",children:"..."},`ellipsis-${x}`):k.jsx("button",{className:`pagination-page ${i===n?"active":""}`,onClick:()=>S(i),children:i},i))}),k.jsx("button",{className:"pagination-btn",onClick:()=>S(n+1),disabled:u,title:"Επόμενη",children:"▶️"}),k.jsx("button",{className:"pagination-btn",onClick:()=>S(e),disabled:u,title:"Τελευταία σελίδα",children:"⏭️"})]})]})});export{P,H as a,F as u};
