import{b as ke,a as Pe,u as Ue,c as Fe,E as S,j as e,d as D,e as $e,_ as G}from"./index-D7UZowsJ.js";import{S as qe}from"./Skeleton-D5FN9Rmh.js";import{r as p}from"./vendor-react-KfUPlHYY.js";import{u as Me}from"./Toast-Clw7ASqT.js";import{u as Ie,a as Re,P as Le}from"./Pagination-DlkObIsn.js";import{c as K,g as Q}from"./costCalculations-BerXyv4h.js";import"./vendor-supabase-B4amk4rL.js";import"./fixedCosts-Dl8kuOQz.js";function Oe(){const{events:h,loading:R,error:L,createEvent:B,updateEvent:H,deleteEvent:J,refresh:O,updateStatus:W}=ke(),{recipes:x}=Pe(),{ingredients:y}=Ue(),{settings:l}=Fe(),{showToast:r,showConfirm:X}=Me(),g=(s,n,t)=>{const c=s.target.value===""?(t==null?void 0:t.fallback)??0:Number(s.target.value);if(s.target.value!==""&&(isNaN(c)||(t==null?void 0:t.min)!==void 0&&c<t.min)){r("Î Î±ÏÎ±ÎºÎ±Î»ÏŽ ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ Î±ÏÎ¹Î¸Î¼ÏŒ","warning"),n((t==null?void 0:t.fallback)??0);return}n(c)},{recordDelete:Z,recordUpdate:ee}=Ie(),[k,P]=p.useState(!1),[f,V]=p.useState(null),[j,z]=p.useState(""),[b,se]=p.useState(""),[a,i]=p.useState({name:"",client_name:"",client_email:"",client_phone:"",event_date:"",event_location:"",guests:10,pricing_mode:"per_person",staff_count:0,staff_hours:0,include_staff_in_price:!0,transport_km:0,equipment_cost:0,equipment_notes:"",notes:"",status:"draft",recipes:[]}),[o,N]=p.useState({recipe_id:0,servings:1,price_override:null}),[C,A]=p.useState("list"),U=()=>{const s=new Date;return new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()))},[F,$]=p.useState(()=>U()),ne=s=>{const n=s.getUTCFullYear(),t=s.getUTCMonth(),c=new Date(Date.UTC(n,t,1)),d=new Date(Date.UTC(n,t+1,0)).getUTCDate(),_=c.getUTCDay();return{daysInMonth:d,startingDay:_,year:n,month:t}},q=s=>{if(!s)return"";let n=typeof s=="string"?new Date(s):s;return isNaN(n.getTime())?"":n.toISOString().slice(0,10)},te=s=>{const n=q(s);return h.filter(t=>q(t.event_date)===n)},ae=(s,n,t)=>new Date(Date.UTC(s,n,t)).toISOString().slice(0,10),ie=["Î™Î±Î½Î¿Ï…Î¬ÏÎ¹Î¿Ï‚","Î¦ÎµÎ²ÏÎ¿Ï…Î¬ÏÎ¹Î¿Ï‚","ÎœÎ¬ÏÏ„Î¹Î¿Ï‚","Î‘Ï€ÏÎ¯Î»Î¹Î¿Ï‚","ÎœÎ¬Î¹Î¿Ï‚","Î™Î¿ÏÎ½Î¹Î¿Ï‚","Î™Î¿ÏÎ»Î¹Î¿Ï‚","Î‘ÏÎ³Î¿Ï…ÏƒÏ„Î¿Ï‚","Î£ÎµÏ€Ï„Î­Î¼Î²ÏÎ¹Î¿Ï‚","ÎŸÎºÏ„ÏŽÎ²ÏÎ¹Î¿Ï‚","ÎÎ¿Î­Î¼Î²ÏÎ¹Î¿Ï‚","Î”ÎµÎºÎ­Î¼Î²ÏÎ¹Î¿Ï‚"],re=["ÎšÏ…Ï","Î”ÎµÏ…","Î¤ÏÎ¯","Î¤ÎµÏ„","Î Î­Î¼","Î Î±Ï","Î£Î¬Î²"],ce=()=>{$(s=>{const n=s.getUTCFullYear(),t=s.getUTCMonth();return new Date(Date.UTC(n,t-1,1))})},le=()=>{$(s=>{const n=s.getUTCFullYear(),t=s.getUTCMonth();return new Date(Date.UTC(n,t+1,1))})},oe=()=>{$(U())},M=()=>{i({name:"",client_name:"",client_email:"",client_phone:"",event_date:"",event_location:"",guests:10,pricing_mode:"per_person",staff_count:0,staff_hours:0,include_staff_in_price:!0,transport_km:0,equipment_cost:0,equipment_notes:"",notes:"",status:"draft",recipes:[]}),V(null),P(!1),N({recipe_id:0,servings:1,price_override:null})},Y=s=>{i({...s,client_name:s.client_name||"",client_email:s.client_email||"",client_phone:s.client_phone||"",event_date:s.event_date||"",event_location:s.event_location||"",equipment_notes:s.equipment_notes||"",notes:s.notes||"",recipes:s.recipes}),V(s.id),P(!0)},de=()=>{if(!o.recipe_id||o.servings<=0){r("Î•Ï€Î¹Î»Î­Î¾Ï„Îµ ÏƒÏ…Î½Ï„Î±Î³Î® ÎºÎ±Î¹ Î¼ÎµÏÎ¯Î´ÎµÏ‚","warning");return}if(o.price_override!==void 0&&o.price_override!==null&&(isNaN(o.price_override)||o.price_override<0)){r("Î— Ï„Î¹Î¼Î®/Î¬Ï„Î¿Î¼Î¿ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼Î· Î±ÏÎ½Î·Ï„Î¹ÎºÏŒÏ‚ Î±ÏÎ¹Î¸Î¼ÏŒÏ‚.","warning");return}if((a.recipes||[]).some(t=>t.recipe_id===o.recipe_id)){r("Î— ÏƒÏ…Î½Ï„Î±Î³Î® Î­Ï‡ÎµÎ¹ Î®Î´Î· Ï€ÏÎ¿ÏƒÏ„ÎµÎ¸ÎµÎ¯ ÏƒÏ„Î¿ event.","warning");return}const s=x.find(t=>t.id===o.recipe_id);if(!s){r("Î— ÏƒÏ…Î½Ï„Î±Î³Î® Î´ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎµ","error");return}const n={recipe_id:o.recipe_id,recipe_name:s.name,servings:o.servings,price_override:o.price_override||null};i({...a,recipes:[...a.recipes||[],n]}),N({recipe_id:0,servings:1,price_override:null})},me=s=>{const n=[...a.recipes||[]];n.splice(s,1),i({...a,recipes:n})},ue=async s=>{if(s.preventDefault(),!a.name||a.name.trim()===""){r("Î£Ï…Î¼Ï€Î»Î·ÏÏŽÏƒÏ„Îµ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Ï„Î¿Ï… event","warning");return}const n={id:f??void 0,name:a.name.trim(),client_name:a.client_name||null,client_email:a.client_email||null,client_phone:a.client_phone||null,event_date:a.event_date||null,event_location:a.event_location||null,guests:a.guests||1,pricing_mode:a.pricing_mode||"per_person",staff_count:a.staff_count||0,staff_hours:a.staff_hours||0,include_staff_in_price:a.include_staff_in_price??!0,transport_km:a.transport_km||0,equipment_cost:a.equipment_cost||0,equipment_notes:a.equipment_notes||null,notes:a.notes||null,status:a.status||"draft",recipes:a.recipes||[]};try{if(f){const t=h.find(c=>c.id===f);t&&ee("event",t,t.name),await H(n),r("Î¤Î¿ event ÎµÎ½Î·Î¼ÎµÏÏŽÎ¸Î·ÎºÎµ","success")}else await B(n),r("Î¤Î¿ event Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ","success");M()}catch(t){r(`Î£Ï†Î¬Î»Î¼Î±: ${t}`,"error")}},pe=s=>{const n=h.find(t=>t.id===s);n&&X(`Î”Î¹Î±Î³ÏÎ±Ï†Î® "${n.name}";`,async()=>{try{Z("event",n,n.name),await J(s),r("Î¤Î¿ event Î´Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ","success")}catch(t){r(`Î£Ï†Î¬Î»Î¼Î±: ${t}`,"error")}})},he=async(s,n)=>{try{await W(s,n),r("Î— ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎµÎ½Î·Î¼ÎµÏÏŽÎ¸Î·ÎºÎµ","success")}catch(t){r(`Î£Ï†Î¬Î»Î¼Î±: ${t}`,"error")}},_e=async s=>{try{const{duplicateEvent:n}=await G(async()=>{const{duplicateEvent:t}=await import("./tauri-vzOShXsj.js");return{duplicateEvent:t}},[]);await n(s),O(),r("Î¤Î¿ event Î±Î½Ï„Î¹Î³ÏÎ¬Ï†Î·ÎºÎµ","success")}catch(n){r(`Î£Ï†Î¬Î»Î¼Î±: ${n}`,"error")}},ve=async s=>{const n=K(s,x,y,l);if(!l){r("Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÏÏ…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚","warning");return}try{const{exportEventPdf:t}=await G(async()=>{const{exportEventPdf:m}=await import("./tauri-vzOShXsj.js");return{exportEventPdf:m}},[]),c=l.company_name||"My Company",u=[];l.company_phone&&u.push(`Tel: ${l.company_phone}`),l.company_email&&u.push(`Email: ${l.company_email}`),l.company_address&&u.push(l.company_address),l.company_vat_number&&u.push(`VAT: ${l.company_vat_number}`);const d=u.length>0?u.join(" | "):"",_={event_name:s.name,event_date:s.event_date||null,event_location:s.event_location||null,client_name:s.client_name||null,client_email:s.client_email||null,client_phone:s.client_phone||null,guests:s.guests,menu_items:(s.recipes||[]).map(m=>{const E=x.find(De=>De.id===m.recipe_id),I=E?Q(E,y,l):{pricePerServing:0},v=m.price_override??I.pricePerServing;return{name:m.recipe_name||"Unknown",servings:m.servings,price:v*m.servings}}),food_cost:n.costTotal,staff_cost:n.staffCost,transport_cost:n.transportCost,equipment_cost:n.equipmentCost,subtotal:n.total/(1+l.vat_rate/100),vat_percent:l.vat_rate,vat_amount:n.total-n.total/(1+l.vat_rate/100),total:n.total,price_per_person:n.perGuest,notes:s.notes||null,company_name:c,company_info:d};await t(_),r("PDF ÎµÎ¾Î®Ï‡Î¸Î· Î¼Îµ ÎµÏ€Î¹Ï„Ï…Ï‡Î¯Î±","success")}catch(t){String(t)!=="Cancelled"&&r(`Î£Ï†Î¬Î»Î¼Î±: ${t}`,"error")}},w=p.useMemo(()=>h.filter(s=>{const n=j===""||s.name.toLowerCase().includes(j.toLowerCase())||s.client_name&&s.client_name.toLowerCase().includes(j.toLowerCase())||s.event_location&&s.event_location.toLowerCase().includes(j.toLowerCase()),t=b===""||s.status===b;return n&&t}),[h,j,b]),{currentPageData:xe,currentPage:ge,totalPages:je,pageSize:fe,pageSizeOptions:Ne,rangeDisplay:ye,isFirstPage:be,isLastPage:Ce,goToPage:we,setPageSize:Te}=Re(w,{initialPageSize:10,pageSizeOptions:[5,10,20,50]}),Ee=s=>Q(s,y,l),Se=s=>K(s,x,y,l),T=S.reduce((s,n)=>(s[n]=h.filter(t=>t.status===n).length,s),{draft:0,quote_sent:0,confirmed:0,completed:0,cancelled:0});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"toolbar",children:[e.jsx("button",{className:"btn-primary",onClick:()=>{M(),P(!k)},children:k?"âœ• ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿":"+ ÎÎ­Î¿ Event"}),e.jsx("button",{className:"btn-secondary",onClick:O,title:"Î‘Î½Î±Î½Î­Ï‰ÏƒÎ·",children:"ðŸ”„"}),e.jsxs("div",{className:"view-toggle",children:[e.jsx("button",{className:`toggle-btn ${C==="list"?"active":""}`,onClick:()=>A("list"),children:"ðŸ“‹ Î›Î¯ÏƒÏ„Î±"}),e.jsx("button",{className:`toggle-btn ${C==="calendar"?"active":""}`,onClick:()=>A("calendar"),children:"ðŸ“… Î—Î¼ÎµÏÎ¿Î»ÏŒÎ³Î¹Î¿"})]})]}),e.jsxs("div",{className:"event-stats",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-label",children:"Î£ÏÎ½Î¿Î»Î¿"}),e.jsx("span",{className:"stat-value",children:h.length})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-label",children:"Î•Î Î™Î’Î•Î’Î‘Î™Î©ÎœÎ•ÎÎ‘"}),e.jsx("span",{className:"stat-value",children:T.confirmed})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-label",children:"Î Î¡ÎŸÎ£Î¦ÎŸÎ¡Î•Î£"}),e.jsx("span",{className:"stat-value",children:T.draft+T.quote_sent})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("span",{className:"stat-label",children:"ÎŸÎ›ÎŸÎšÎ›Î—Î¡Î©ÎœÎ•ÎÎ‘"}),e.jsx("span",{className:"stat-value",children:T.completed})]})]}),e.jsxs("div",{className:"search-bar",children:[e.jsxs("div",{className:"search-input-wrapper",children:[e.jsx("span",{className:"search-icon",children:"ðŸ”"}),e.jsx("input",{type:"text",placeholder:"Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· event Î® Ï€ÎµÎ»Î¬Ï„Î·...",value:j,onChange:s=>z(s.target.value),className:"search-input"}),j&&e.jsx("button",{className:"btn-icon clear-search",onClick:()=>z(""),children:"âœ•"})]}),e.jsxs("select",{value:b,onChange:s=>se(s.target.value),className:"filter-select",children:[e.jsx("option",{value:"",children:"ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎºÎ±Ï„Î±ÏƒÏ„Î¬ÏƒÎµÎ¹Ï‚"}),S.map(s=>e.jsx("option",{value:s,children:D[s]},s))]}),e.jsxs("span",{className:"results-count",children:[w.length," / ",h.length]})]}),k&&e.jsxs("form",{onSubmit:ue,className:"form",children:[e.jsx("h3",{className:"form-title",children:f?"âœï¸ Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Event":"âž• ÎÎ­Î¿ Event"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",style:{flex:2},children:[e.jsx("label",{children:"ÎŒÎ½Î¿Î¼Î± Event:"}),e.jsx("input",{type:"text",value:a.name,onChange:s=>i({...a,name:s.target.value}),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±:"}),e.jsx("input",{type:"date",value:a.event_date||"",onChange:s=>i({...a,event_date:s.target.value})})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Î ÎµÎ»Î¬Ï„Î·Ï‚:"}),e.jsx("input",{type:"text",value:a.client_name||"",onChange:s=>i({...a,client_name:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Email:"}),e.jsx("input",{type:"email",value:a.client_email||"",onChange:s=>i({...a,client_email:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Î¤Î·Î»Î­Ï†Ï‰Î½Î¿:"}),e.jsx("input",{type:"text",value:a.client_phone||"",onChange:s=>i({...a,client_phone:s.target.value})})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",style:{flex:1.5},children:[e.jsx("label",{children:"Î¤Î¿Ï€Î¿Î¸ÎµÏƒÎ¯Î±:"}),e.jsx("input",{type:"text",value:a.event_location||"",onChange:s=>i({...a,event_location:s.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ÎšÎ±Î»ÎµÏƒÎ¼Î­Î½Î¿Î¹:"}),e.jsx("input",{type:"number",min:"1",value:a.guests,onChange:s=>g(s,n=>i({...a,guests:n}),{min:1,fallback:1})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Mode Î¤Î¹Î¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·Ï‚:"}),e.jsx("select",{value:a.pricing_mode,onChange:s=>i({...a,pricing_mode:s.target.value}),children:$e.map(s=>e.jsx("option",{value:s,children:s==="per_person"?"Î‘Î½Î¬ Î¬Ï„Î¿Î¼Î¿":"Î‘Î½Î¬ event"},s))})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Î ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÏŒ (#):"}),e.jsx("input",{type:"number",min:"0",value:a.staff_count,onChange:s=>g(s,n=>i({...a,staff_count:n}),{min:0,fallback:0})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ÎÏÎµÏ‚ Ï€ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÎ¿Ï:"}),e.jsx("input",{type:"number",min:"0",step:"0.5",value:a.staff_hours,onChange:s=>g(s,n=>i({...a,staff_hours:n}),{min:0,fallback:0})})]}),e.jsxs("div",{className:"form-group checkbox",children:[e.jsx("label",{children:"Î£Ï…Î¼Ï€. Ï€ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÏŒ ÏƒÏ„Î·Î½ Ï„Î¹Î¼Î®:"}),e.jsx("input",{type:"checkbox",checked:a.include_staff_in_price,onChange:s=>i({...a,include_staff_in_price:s.target.checked})})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬ (Ï‡Î»Î¼):"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:a.transport_km,onChange:s=>g(s,n=>i({...a,transport_km:n}),{min:0,fallback:0})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Î•Î¾Î¿Ï€Î»Î¹ÏƒÎ¼ÏŒÏ‚ (â‚¬):"}),e.jsx("input",{type:"number",min:"0",step:"1",value:a.equipment_cost,onChange:s=>g(s,n=>i({...a,equipment_cost:n}),{min:0,fallback:0})})]}),e.jsxs("div",{className:"form-group",style:{flex:1.5},children:[e.jsx("label",{children:"ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·:"}),e.jsx("select",{value:a.status,onChange:s=>i({...a,status:s.target.value}),children:S.map(s=>e.jsx("option",{value:s,children:D[s]},s))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Î£Î·Î¼ÎµÎ¹ÏŽÏƒÎµÎ¹Ï‚ ÎµÎ¾Î¿Ï€Î»Î¹ÏƒÎ¼Î¿Ï:"}),e.jsx("textarea",{value:a.equipment_notes||"",onChange:s=>i({...a,equipment_notes:s.target.value}),rows:2})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Î£Î·Î¼ÎµÎ¹ÏŽÏƒÎµÎ¹Ï‚:"}),e.jsx("textarea",{value:a.notes||"",onChange:s=>i({...a,notes:s.target.value}),rows:2})]}),e.jsxs("div",{className:"ingredients-section",children:[e.jsx("h3",{children:"ÎœÎµÎ½Î¿Ï / Î£Ï…Î½Ï„Î±Î³Î­Ï‚"}),e.jsxs("div",{className:"add-ingredient-row",children:[e.jsxs("select",{value:o.recipe_id,onChange:s=>N({...o,recipe_id:parseInt(s.target.value)}),children:[e.jsx("option",{value:0,children:"-- Î•Ï€Î¹Î»Î­Î¾Ï„Îµ ÏƒÏ…Î½Ï„Î±Î³Î® --"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("input",{type:"number",min:"1",step:"1",placeholder:"ÎœÎµÏÎ¯Î´ÎµÏ‚",value:o.servings,onChange:s=>g(s,n=>N({...o,servings:n}),{min:1,fallback:1})}),e.jsx("input",{type:"number",step:"0.1",placeholder:"Î¤Î¹Î¼Î®/Î¬Ï„Î¿Î¼Î¿ (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)",value:o.price_override||"",onChange:s=>g(s,n=>N({...o,price_override:n}),{min:0,fallback:0})}),e.jsx("button",{type:"button",className:"btn-icon",onClick:de,children:"âž•"})]}),a.recipes&&a.recipes.length>0&&e.jsx("ul",{className:"ingredient-list",children:a.recipes.map((s,n)=>{var t;return e.jsxs("li",{children:[e.jsxs("span",{children:[((t=x.find(c=>c.id===s.recipe_id))==null?void 0:t.name)||"Î£Ï…Î½Ï„Î±Î³Î®"," - ",s.servings," ÏƒÎµÏÎ²."]}),e.jsxs("div",{className:"event-recipe-meta",children:[e.jsx("small",{children:s.price_override?`${s.price_override.toFixed(2)} â‚¬/Î¬Ï„Î¿Î¼Î¿`:"Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î· Ï„Î¹Î¼Î¿Î»ÏŒÎ³Î·ÏƒÎ·"}),e.jsx("button",{type:"button",className:"btn-icon",onClick:()=>me(n),children:"âœ•"})]})]},`${s.recipe_id}-${n}`)})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn-primary",children:f?"ðŸ’¾ Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·":"ðŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·"}),f&&e.jsx("button",{type:"button",className:"btn-secondary",onClick:M,children:"Î‘ÎºÏÏÏ‰ÏƒÎ·"})]})]}),R&&e.jsx(qe,{count:4}),L&&e.jsxs("p",{className:"error",children:["Î£Ï†Î¬Î»Î¼Î±: ",L]}),C==="calendar"&&e.jsxs("div",{className:"calendar-container",children:[e.jsxs("div",{className:"calendar-header",children:[e.jsx("button",{className:"btn-icon",onClick:ce,children:"â—€"}),e.jsxs("h3",{children:[ie[F.getUTCMonth()]," ",F.getUTCFullYear()]}),e.jsx("button",{className:"btn-icon",onClick:le,children:"â–¶"}),e.jsx("button",{className:"btn-secondary",onClick:oe,children:"Î£Î®Î¼ÎµÏÎ±"})]}),e.jsxs("div",{className:"calendar-grid",children:[re.map(s=>e.jsx("div",{className:"calendar-day-header",children:s},s)),(()=>{const{daysInMonth:s,startingDay:n,year:t,month:c}=ne(F),u=[];for(let d=0;d<n;d++)u.push(e.jsx("div",{className:"calendar-day empty"},`empty-${d}`));for(let d=1;d<=s;d++){const _=ae(t,c,d),m=te(_),E=q(U()),I=_===E;u.push(e.jsxs("div",{className:`calendar-day ${I?"today":""} ${m.length>0?"has-events":""}`,children:[e.jsx("span",{className:"day-number",children:d}),e.jsxs("div",{className:"day-events",children:[m.slice(0,3).map(v=>e.jsxs("div",{className:`day-event status-${v.status}`,onClick:()=>Y(v),title:v.name,children:[v.name.substring(0,15),v.name.length>15?"...":""]},v.id)),m.length>3&&e.jsxs("div",{className:"day-event more",children:["+",m.length-3," Î±ÎºÏŒÎ¼Î±"]})]})]},d))}return u})()]})]}),C==="list"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"events-grid",children:[xe.map(s=>{const n=Se(s);return e.jsxs("div",{className:"event-card card",children:[e.jsxs("div",{className:"event-header",children:[e.jsxs("div",{children:[e.jsx("h3",{children:s.name}),e.jsxs("div",{className:"event-meta",children:[s.event_date&&e.jsxs("span",{children:["ðŸ“… ",s.event_date]}),s.event_location&&e.jsxs("span",{children:["ðŸ“ ",s.event_location]}),s.client_name&&e.jsxs("span",{children:["ðŸ‘¤ ",s.client_name]})]})]}),e.jsx("span",{className:`status-pill status-${s.status}`,children:D[s.status]})]}),e.jsxs("div",{className:"event-body",children:[e.jsxs("div",{className:"event-info-row",children:[e.jsxs("span",{children:["ðŸ‘¥ ",s.guests," Î¬Ï„Î¿Î¼Î±"]}),e.jsxs("span",{children:["ðŸ§¾ Mode: ",s.pricing_mode==="per_person"?"per person":"per event"]}),e.jsxs("span",{children:["ðŸšš ",s.transport_km," km"]})]}),e.jsxs("div",{className:"event-recipes",children:[e.jsx("h4",{children:"ÎœÎµÎ½Î¿Ï"}),(s.recipes||[]).length===0&&e.jsx("p",{className:"empty-state",children:"Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ ÏƒÏ…Î½Ï„Î±Î³Î­Ï‚ Î³Î¹Î± Î½Î± ÎºÎ¿ÏƒÏ„Î¿Î»Î¿Î³Î®ÏƒÎµÏ„Îµ"}),(s.recipes||[]).map(t=>{const c=x.find(m=>m.id===t.recipe_id);if(!c)return null;const u=Ee(c),_=(t.price_override??u.pricePerServing)*t.servings;return e.jsxs("div",{className:"event-recipe-row",children:[e.jsxs("div",{children:[e.jsx("div",{className:"event-recipe-name",children:c.name}),e.jsxs("small",{children:[t.servings," ÏƒÎµÏÎ². Â· ",t.price_override?"Î ÏÎ¿ÏƒÎ±ÏÎ¼.":"Î‘Ï…Ï„ÏŒÎ¼."," Ï„Î¹Î¼Î®"]})]}),e.jsxs("div",{className:"event-recipe-price",children:[_.toFixed(2)," â‚¬"]})]},t.id||`${t.recipe_id}-${t.servings}`)})]}),e.jsxs("div",{className:"event-summary",children:[e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Î¤Î¹Î¼Î®/Î¬Ï„Î¿Î¼Î¿"}),e.jsxs("strong",{children:[n.perGuest.toFixed(2)," â‚¬"]})]}),e.jsxs("div",{className:"summary-item",children:[e.jsx("span",{children:"Î£ÏÎ½Î¿Î»Î¿ Event"}),e.jsxs("strong",{children:[n.total.toFixed(2)," â‚¬"]})]}),e.jsxs("div",{className:"summary-item subtle",children:[e.jsx("span",{children:"Î ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÏŒ/ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬/Î•Î¾Î¿Ï€Î»Î¹ÏƒÎ¼ÏŒÏ‚"}),e.jsxs("strong",{children:[(n.staffCost+n.transportCost+n.equipmentCost).toFixed(2)," â‚¬"]})]}),e.jsxs("div",{className:"summary-item profit",children:[e.jsx("span",{children:"ÎšÎ­ÏÎ´Î¿Ï‚"}),e.jsxs("strong",{children:[n.profitMargin.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"card-actions",children:[e.jsx("button",{className:"btn-icon pdf",onClick:()=>ve(s),title:"Export PDF",children:"ðŸ“„"}),e.jsx("select",{value:s.status,onChange:t=>he(s.id,t.target.value),className:"status-select",children:S.map(t=>e.jsx("option",{value:t,children:D[t]},t))}),e.jsx("button",{className:"btn-icon copy",onClick:()=>_e(s.id),title:"Î‘Î½Ï„Î¹Î³ÏÎ±Ï†Î®",children:"ðŸ“‹"}),e.jsx("button",{className:"btn-secondary",onClick:()=>Y(s),children:"âœï¸ Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±"}),e.jsx("button",{className:"btn-danger",onClick:()=>pe(s.id),children:"ðŸ—‘ï¸"})]})]},s.id)}),w.length===0&&!R&&e.jsx("p",{className:"empty-state",children:"Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ events Î¼Îµ Î±Ï…Ï„Î¬ Ï„Î± ÎºÏÎ¹Ï„Î®ÏÎ¹Î±"})]}),w.length>0&&e.jsx(Le,{currentPage:ge,totalPages:je,pageSize:fe,pageSizeOptions:Ne,rangeDisplay:ye,isFirstPage:be,isLastPage:Ce,onPageChange:we,onPageSizeChange:Te})]})]})}const He=p.memo(Oe);export{He as default};
