import{j as s,u as ve,I as be,U as je,_ as ke}from"./index-D7UZowsJ.js";import{g as we,c as Se,r as J}from"./vendor-react-KfUPlHYY.js";import{S as Ee}from"./Skeleton-D5FN9Rmh.js";import{u as Ne}from"./Toast-Clw7ASqT.js";import{u as Ce,a as Re,P as Ie}from"./Pagination-DlkObIsn.js";import{u as Oe,a as Fe}from"./useVirtualScrolling-3HgXsM7l.js";import"./vendor-supabase-B4amk4rL.js";var xe={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(z,Y){((ae,k)=>{z.exports=k()})(Se,function ae(){var k=typeof self<"u"?self:typeof window<"u"?window:k!==void 0?k:{},re,oe=!k.document&&!!k.postMessage,se=k.IS_PAPA_WORKER||!1,X={},U=0,u={};function Q(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var i=G(t);i.chunkSize=parseInt(i.chunkSize),t.step||t.chunk||(i.chunkSize=null),this._handle=new he(i),(this._handle.streamer=this)._config=i}).call(this,e),this.parseChunk=function(t,i){var a=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<a){let p=this._config.newline;p||(n=this._config.quoteChar||'"',p=this._handle.guessLineEndings(t,n)),t=[...t.split(p).slice(a)].join(p)}this.isFirstChunk&&v(this._config.beforeFirstChunk)&&(n=this._config.beforeFirstChunk(t))!==void 0&&(t=n),this.isFirstChunk=!1,this._halted=!1;var a=this._partialLine+t,n=(this._partialLine="",this._handle.parse(a,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=n.meta.cursor,a=(this._finished||(this._partialLine=a.substring(t-this._baseIndex),this._baseIndex=t),n&&n.data&&(this._rowCount+=n.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),se)k.postMessage({results:n,workerId:u.WORKER_ID,finished:a});else if(v(this._config.chunk)&&!i){if(this._config.chunk(n,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=n=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),this._completed||!a||!v(this._config.complete)||n&&n.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),a||n&&n.meta.paused||this._nextChunk(),n}this._halted=!0},this._sendError=function(t){v(this._config.error)?this._config.error(t):se&&this._config.error&&k.postMessage({workerId:u.WORKER_ID,error:t,finished:!1})}}function D(e){var t;(e=e||{}).chunkSize||(e.chunkSize=u.RemoteChunkSize),Q.call(this,e),this._nextChunk=oe?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(i){this._input=i,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),oe||(t.onload=te(this._chunkLoaded,this),t.onerror=te(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!oe),this._config.downloadRequestHeaders){var i,a=this._config.downloadRequestHeaders;for(i in a)t.setRequestHeader(i,a[i])}var n;this._config.chunkSize&&(n=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+n));try{t.send(this._config.downloadRequestBody)}catch(p){this._chunkError(p.message)}oe&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(i=>(i=i.getResponseHeader("Content-Range"))!==null?parseInt(i.substring(i.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(i){i=t.statusText||i,this._sendError(new Error(i))}}function Z(e){(e=e||{}).chunkSize||(e.chunkSize=u.LocalChunkSize),Q.call(this,e);var t,i,a=typeof FileReader<"u";this.stream=function(n){this._input=n,i=n.slice||n.webkitSlice||n.mozSlice,a?((t=new FileReader).onload=te(this._chunkLoaded,this),t.onerror=te(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var n=this._input,p=(this._config.chunkSize&&(p=Math.min(this._start+this._config.chunkSize,this._input.size),n=i.call(n,this._start,p)),t.readAsText(n,this._config.encoding));a||this._chunkLoaded({target:{result:p}})},this._chunkLoaded=function(n){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(n.target.result)},this._chunkError=function(){this._sendError(t.error)}}function ee(e){var t;Q.call(this,e=e||{}),this.stream=function(i){return t=i,this._nextChunk()},this._nextChunk=function(){var i,a;if(!this._finished)return i=this._config.chunkSize,t=i?(a=t.substring(0,i),t.substring(i)):(a=t,""),this._finished=!t,this.parseChunk(a)}}function P(e){Q.call(this,e=e||{});var t=[],i=!0,a=!1;this.pause=function(){Q.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){Q.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(n){this._input=n,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){a&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=te(function(n){try{t.push(typeof n=="string"?n:n.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(p){this._streamError(p)}},this),this._streamError=te(function(n){this._streamCleanUp(),this._sendError(n)},this),this._streamEnd=te(function(){this._streamCleanUp(),a=!0,this._streamData("")},this),this._streamCleanUp=te(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function he(e){var t,i,a,n,p=Math.pow(2,53),S=-p,H=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,q=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,_=this,N=0,d=0,L=!1,f=!1,y=[],l={data:[],errors:[],meta:{}};function O(m){return e.skipEmptyLines==="greedy"?m.join("").trim()==="":m.length===1&&m[0].length===0}function I(){if(l&&a&&(W("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),a=!1),e.skipEmptyLines&&(l.data=l.data.filter(function(h){return!O(h)})),T()){let h=function(w,F){v(e.transformHeader)&&(w=e.transformHeader(w,F)),y.push(w)};if(l)if(Array.isArray(l.data[0])){for(var m=0;T()&&m<l.data.length;m++)l.data[m].forEach(h);l.data.splice(0,1)}else l.data.forEach(h)}function x(h,w){for(var F=e.header?{}:[],b=0;b<h.length;b++){var r=b,o=h[b],o=((g,c)=>(j=>(e.dynamicTypingFunction&&e.dynamicTyping[j]===void 0&&(e.dynamicTyping[j]=e.dynamicTypingFunction(j)),(e.dynamicTyping[j]||e.dynamicTyping)===!0))(g)?c==="true"||c==="TRUE"||c!=="false"&&c!=="FALSE"&&((j=>{if(H.test(j)&&(j=parseFloat(j),S<j&&j<p))return 1})(c)?parseFloat(c):q.test(c)?new Date(c):c===""?null:c):c)(r=e.header?b>=y.length?"__parsed_extra":y[b]:r,o=e.transform?e.transform(o,r):o);r==="__parsed_extra"?(F[r]=F[r]||[],F[r].push(o)):F[r]=o}return e.header&&(b>y.length?W("FieldMismatch","TooManyFields","Too many fields: expected "+y.length+" fields but parsed "+b,d+w):b<y.length&&W("FieldMismatch","TooFewFields","Too few fields: expected "+y.length+" fields but parsed "+b,d+w)),F}var C;l&&(e.header||e.dynamicTyping||e.transform)&&(C=1,!l.data.length||Array.isArray(l.data[0])?(l.data=l.data.map(x),C=l.data.length):l.data=x(l.data,0),e.header&&l.meta&&(l.meta.fields=y),d+=C)}function T(){return e.header&&y.length===0}function W(m,x,C,h){m={type:m,code:x,message:C},h!==void 0&&(m.row=h),l.errors.push(m)}v(e.step)&&(n=e.step,e.step=function(m){l=m,T()?I():(I(),l.data.length!==0&&(N+=m.data.length,e.preview&&N>e.preview?i.abort():(l.data=l.data[0],n(l,_))))}),this.parse=function(m,x,C){var h=e.quoteChar||'"',h=(e.newline||(e.newline=this.guessLineEndings(m,h)),a=!1,e.delimiter?v(e.delimiter)&&(e.delimiter=e.delimiter(m),l.meta.delimiter=e.delimiter):((h=((w,F,b,r,o)=>{var g,c,j,$;o=o||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var E=0;E<o.length;E++){for(var B,fe=o[E],M=0,ie=0,A=0,K=(j=void 0,new ue({comments:r,delimiter:fe,newline:F,preview:10}).parse(w)),le=0;le<K.data.length;le++)b&&O(K.data[le])?A++:(B=K.data[le].length,ie+=B,j===void 0?j=B:0<B&&(M+=Math.abs(B-j),j=B));0<K.data.length&&(ie/=K.data.length-A),(c===void 0||M<=c)&&($===void 0||$<ie)&&1.99<ie&&(c=M,g=fe,$=ie)}return{successful:!!(e.delimiter=g),bestDelimiter:g}})(m,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=h.bestDelimiter:(a=!0,e.delimiter=u.DefaultDelimiter),l.meta.delimiter=e.delimiter),G(e));return e.preview&&e.header&&h.preview++,t=m,i=new ue(h),l=i.parse(t,x,C),I(),L?{meta:{paused:!0}}:l||{meta:{paused:!1}}},this.paused=function(){return L},this.pause=function(){L=!0,i.abort(),t=v(e.chunk)?"":t.substring(i.getCharIndex())},this.resume=function(){_.streamer._halted?(L=!1,_.streamer.parseChunk(t,!0)):setTimeout(_.resume,3)},this.aborted=function(){return f},this.abort=function(){f=!0,i.abort(),l.meta.aborted=!0,v(e.complete)&&e.complete(l),t=""},this.guessLineEndings=function(w,h){w=w.substring(0,1048576);var h=new RegExp(V(h)+"([^]*?)"+V(h),"gm"),C=(w=w.replace(h,"")).split("\r"),h=w.split(`
`),w=1<h.length&&h[0].length<C[0].length;if(C.length===1||w)return`
`;for(var F=0,b=0;b<C.length;b++)C[b][0]===`
`&&F++;return F>=C.length/2?`\r
`:"\r"}}function V(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ue(e){var t=(e=e||{}).delimiter,i=e.newline,a=e.comments,n=e.step,p=e.preview,S=e.fastMode,H=null,q=!1,_=e.quoteChar==null?'"':e.quoteChar,N=_;if(e.escapeChar!==void 0&&(N=e.escapeChar),(typeof t!="string"||-1<u.BAD_DELIMITERS.indexOf(t))&&(t=","),a===t)throw new Error("Comment character same as delimiter");a===!0?a="#":(typeof a!="string"||-1<u.BAD_DELIMITERS.indexOf(a))&&(a=!1),i!==`
`&&i!=="\r"&&i!==`\r
`&&(i=`
`);var d=0,L=!1;this.parse=function(f,y,l){if(typeof f!="string")throw new Error("Input must be a string");var O=f.length,I=t.length,T=i.length,W=a.length,m=v(n),x=[],C=[],h=[],w=d=0;if(!f)return M();if(S||S!==!1&&f.indexOf(_)===-1){for(var F=f.split(i),b=0;b<F.length;b++){if(h=F[b],d+=h.length,b!==F.length-1)d+=i.length;else if(l)return M();if(!a||h.substring(0,W)!==a){if(m){if(x=[],$(h.split(t)),ie(),L)return M()}else $(h.split(t));if(p&&p<=b)return x=x.slice(0,p),M(!0)}}return M()}for(var r=f.indexOf(t,d),o=f.indexOf(i,d),g=new RegExp(V(N)+V(_),"g"),c=f.indexOf(_,d);;)if(f[d]===_)for(c=d,d++;;){if((c=f.indexOf(_,c+1))===-1)return l||C.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:d}),B();if(c===O-1)return B(f.substring(d,c).replace(g,_));if(_===N&&f[c+1]===N)c++;else if(_===N||c===0||f[c-1]!==N){r!==-1&&r<c+1&&(r=f.indexOf(t,c+1));var j=E((o=o!==-1&&o<c+1?f.indexOf(i,c+1):o)===-1?r:Math.min(r,o));if(f.substr(c+1+j,I)===t){h.push(f.substring(d,c).replace(g,_)),f[d=c+1+j+I]!==_&&(c=f.indexOf(_,d)),r=f.indexOf(t,d),o=f.indexOf(i,d);break}if(j=E(o),f.substring(c+1+j,c+1+j+T)===i){if(h.push(f.substring(d,c).replace(g,_)),fe(c+1+j+T),r=f.indexOf(t,d),c=f.indexOf(_,d),m&&(ie(),L))return M();if(p&&x.length>=p)return M(!0);break}C.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:d}),c++}}else if(a&&h.length===0&&f.substring(d,d+W)===a){if(o===-1)return M();d=o+T,o=f.indexOf(i,d),r=f.indexOf(t,d)}else if(r!==-1&&(r<o||o===-1))h.push(f.substring(d,r)),d=r+I,r=f.indexOf(t,d);else{if(o===-1)break;if(h.push(f.substring(d,o)),fe(o+T),m&&(ie(),L))return M();if(p&&x.length>=p)return M(!0)}return B();function $(A){x.push(A),w=d}function E(A){var K=0;return K=A!==-1&&(A=f.substring(c+1,A))&&A.trim()===""?A.length:K}function B(A){return l||(A===void 0&&(A=f.substring(d)),h.push(A),d=O,$(h),m&&ie()),M()}function fe(A){d=A,$(h),h=[],o=f.indexOf(i,d)}function M(A){if(e.header&&!y&&x.length&&!q){var K=x[0],le=Object.create(null),ge=new Set(K);let _e=!1;for(let de=0;de<K.length;de++){let ne=K[de];if(le[ne=v(e.transformHeader)?e.transformHeader(ne,de):ne]){let pe,ye=le[ne];for(;pe=ne+"_"+ye,ye++,ge.has(pe););ge.add(pe),K[de]=pe,le[ne]++,_e=!0,(H=H===null?{}:H)[pe]=ne}else le[ne]=1,K[de]=ne;ge.add(ne)}_e&&console.warn("Duplicate headers found and renamed."),q=!0}return{data:x,errors:C,meta:{delimiter:t,linebreak:i,aborted:L,truncated:!!A,cursor:w+(y||0),renamedHeaders:H}}}function ie(){n(M()),x=[],C=[]}},this.abort=function(){L=!0},this.getCharIndex=function(){return d}}function ce(e){var t=e.data,i=X[t.workerId],a=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var n={abort:function(){a=!0,me(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:R,resume:R};if(v(i.userStep)){for(var p=0;p<t.results.data.length&&(i.userStep({data:t.results.data[p],errors:t.results.errors,meta:t.results.meta},n),!a);p++);delete t.results}else v(i.userChunk)&&(i.userChunk(t.results,n,t.file),delete t.results)}t.finished&&!a&&me(t.workerId,t.results)}function me(e,t){var i=X[e];v(i.userComplete)&&i.userComplete(t),i.terminate(),delete X[e]}function R(){throw new Error("Not implemented.")}function G(e){if(typeof e!="object"||e===null)return e;var t,i=Array.isArray(e)?[]:{};for(t in e)i[t]=G(e[t]);return i}function te(e,t){return function(){e.apply(t,arguments)}}function v(e){return typeof e=="function"}return u.parse=function(e,t){var i=(t=t||{}).dynamicTyping||!1;if(v(i)&&(t.dynamicTypingFunction=i,i={}),t.dynamicTyping=i,t.transform=!!v(t.transform)&&t.transform,!t.worker||!u.WORKERS_SUPPORTED)return i=null,u.NODE_STREAM_INPUT,typeof e=="string"?(e=(a=>a.charCodeAt(0)!==65279?a:a.slice(1))(e),i=new(t.download?D:ee)(t)):e.readable===!0&&v(e.read)&&v(e.on)?i=new P(t):(k.File&&e instanceof File||e instanceof Object)&&(i=new Z(t)),i.stream(e);(i=(()=>{var a;return!!u.WORKERS_SUPPORTED&&(a=(()=>{var n=k.URL||k.webkitURL||null,p=ae.toString();return u.BLOB_URL||(u.BLOB_URL=n.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",p,")();"],{type:"text/javascript"})))})(),(a=new k.Worker(a)).onmessage=ce,a.id=U++,X[a.id]=a)})()).userStep=t.step,i.userChunk=t.chunk,i.userComplete=t.complete,i.userError=t.error,t.step=v(t.step),t.chunk=v(t.chunk),t.complete=v(t.complete),t.error=v(t.error),delete t.worker,i.postMessage({input:e,config:t,workerId:i.id})},u.unparse=function(e,t){var i=!1,a=!0,n=",",p=`\r
`,S='"',H=S+S,q=!1,_=null,N=!1,d=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||u.BAD_DELIMITERS.filter(function(y){return t.delimiter.indexOf(y)!==-1}).length||(n=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(i=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(q=t.skipEmptyLines),typeof t.newline=="string"&&(p=t.newline),typeof t.quoteChar=="string"&&(S=t.quoteChar),typeof t.header=="boolean"&&(a=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");_=t.columns}t.escapeChar!==void 0&&(H=t.escapeChar+S),t.escapeFormulae instanceof RegExp?N=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(N=/^[=+\-@\t\r].*$/)}})(),new RegExp(V(S),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return L(null,e,q);if(typeof e[0]=="object")return L(_||Object.keys(e[0]),e,q)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||_),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),L(e.fields||[],e.data||[],q);throw new Error("Unable to serialize unrecognized input");function L(y,l,O){var I="",T=(typeof y=="string"&&(y=JSON.parse(y)),typeof l=="string"&&(l=JSON.parse(l)),Array.isArray(y)&&0<y.length),W=!Array.isArray(l[0]);if(T&&a){for(var m=0;m<y.length;m++)0<m&&(I+=n),I+=f(y[m],m);0<l.length&&(I+=p)}for(var x=0;x<l.length;x++){var C=(T?y:l[x]).length,h=!1,w=T?Object.keys(l[x]).length===0:l[x].length===0;if(O&&!T&&(h=O==="greedy"?l[x].join("").trim()==="":l[x].length===1&&l[x][0].length===0),O==="greedy"&&T){for(var F=[],b=0;b<C;b++){var r=W?y[b]:b;F.push(l[x][r])}h=F.join("").trim()===""}if(!h){for(var o=0;o<C;o++){0<o&&!w&&(I+=n);var g=T&&W?y[o]:o;I+=f(l[x][g],o)}x<l.length-1&&(!O||0<C&&!w)&&(I+=p)}}return I}function f(y,l){var O,I;return y==null?"":y.constructor===Date?JSON.stringify(y).slice(1,25):(I=!1,N&&typeof y=="string"&&N.test(y)&&(y="'"+y,I=!0),O=y.toString().replace(d,H),(I=I||i===!0||typeof i=="function"&&i(y,l)||Array.isArray(i)&&i[l]||((T,W)=>{for(var m=0;m<W.length;m++)if(-1<T.indexOf(W[m]))return!0;return!1})(O,u.BAD_DELIMITERS)||-1<O.indexOf(n)||O.charAt(0)===" "||O.charAt(O.length-1)===" ")?S+O+S:O)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!oe&&!!k.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=ue,u.ParserHandle=he,u.NetworkStreamer=D,u.FileStreamer=Z,u.StringStreamer=ee,u.ReadableStreamStreamer=P,k.jQuery&&((re=k.jQuery).fn.parse=function(e){var t=e.config||{},i=[];return this.each(function(p){if(!(re(this).prop("tagName").toUpperCase()==="INPUT"&&re(this).attr("type").toLowerCase()==="file"&&k.FileReader)||!this.files||this.files.length===0)return!0;for(var S=0;S<this.files.length;S++)i.push({file:this.files[S],inputElem:this,instanceConfig:re.extend({},t)})}),a(),this;function a(){if(i.length===0)v(e.complete)&&e.complete();else{var p,S,H,q,_=i[0];if(v(e.before)){var N=e.before(_.file,_.inputElem);if(typeof N=="object"){if(N.action==="abort")return p="AbortError",S=_.file,H=_.inputElem,q=N.reason,void(v(e.error)&&e.error({name:p},S,H,q));if(N.action==="skip")return void n();typeof N.config=="object"&&(_.instanceConfig=re.extend(_.instanceConfig,N.config))}else if(N==="skip")return void n()}var d=_.instanceConfig.complete;_.instanceConfig.complete=function(L){v(d)&&d(L,_.file,_.inputElem),n()},u.parse(_.file,_.instanceConfig)}}function n(){i.splice(0,1),a()}}),se&&(k.onmessage=function(e){e=e.data,u.WORKER_ID===void 0&&e&&(u.WORKER_ID=e.workerId),typeof e.input=="string"?k.postMessage({workerId:u.WORKER_ID,results:u.parse(e.input,e.config),finished:!0}):(k.File&&e.input instanceof File||e.input instanceof Object)&&(e=u.parse(e.input,e.config))&&k.postMessage({workerId:u.WORKER_ID,results:e,finished:!0})}),(D.prototype=Object.create(Q.prototype)).constructor=D,(Z.prototype=Object.create(Q.prototype)).constructor=Z,(ee.prototype=Object.create(ee.prototype)).constructor=ee,(P.prototype=Object.create(Q.prototype)).constructor=P,u})})(xe);var De=xe.exports;const Te=we(De);function Le({ingredient:z,onEdit:Y,onDelete:ae}){return s.jsxs("div",{className:"ingredient-item",children:[s.jsxs("div",{className:"ingredient-info",children:[s.jsx("div",{className:"ingredient-name",children:z.name}),s.jsxs("div",{className:"ingredient-details",children:[s.jsxs("span",{className:"ingredient-price",children:["Î¤Î¹Î¼Î®: ",s.jsxs("strong",{children:[z.price.toFixed(2)," â‚¬"]})]}),s.jsxs("span",{className:"ingredient-unit",children:["ÎœÎ¿Î½Î¬Î´Î±: ",s.jsx("strong",{children:z.unit})]}),s.jsxs("span",{className:"ingredient-waste",children:["Î‘Ï€ÏŽÎ»ÎµÎ¹Î±: ",s.jsxs("strong",{children:[z.waste_percent,"%"]})]}),s.jsxs("span",{className:"ingredient-supplier",children:["Î ÏÎ¿Î¼Î·Î¸ÎµÏ…Ï„Î®Ï‚: ",s.jsx("strong",{children:z.supplier||"-"})]})]})]}),s.jsxs("div",{className:"ingredient-actions",children:[s.jsx("button",{className:"btn-icon edit",onClick:()=>Y(z),"aria-label":"Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±",children:"âœï¸"}),s.jsx("button",{className:"btn-icon delete",onClick:()=>ae(z.id),"aria-label":"Î”Î¹Î±Î³ÏÎ±Ï†Î®",children:"ðŸ—‘ï¸"})]})]})}function Ae({items:z,columns:Y,rowHeight:ae=48,headerHeight:k=48,overscan:re=10,className:oe="",onRowClick:se,rowClassName:X}){const U=J.useRef(null),u=Oe({count:z.length,getScrollElement:()=>U.current,estimateSize:()=>ae,overscan:re}),Q=u.getVirtualItems();return s.jsxs("div",{className:`virtual-table ${oe}`,children:[s.jsx("div",{className:"virtual-table-header",style:{height:k},children:Y.map(D=>s.jsx("div",{className:`virtual-table-header-cell ${D.width?"":"flex-1"}`,style:{width:D.width,...D.headerStyle},children:D.header},D.key))}),s.jsx("div",{ref:U,className:"virtual-table-body",style:{height:`calc(100% - ${k}px)`,overflow:"auto"},children:z.length===0?s.jsx("div",{className:"virtual-table-empty",children:"Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Î±"}):s.jsx("div",{style:{height:`${u.getTotalSize()}px`,width:"100%",position:"relative"},children:Q.map(D=>{const Z=z[D.index],ee=(X==null?void 0:X(Z,D.index))||"";return s.jsx("div",{className:`virtual-table-row ${ee}`,style:{position:"absolute",top:0,left:0,width:"100%",height:`${D.size}px`,transform:`translateY(${D.start}px)`,cursor:se?"pointer":"default"},onClick:()=>se==null?void 0:se(Z,D.index),children:Y.map(P=>s.jsx("div",{className:"virtual-table-cell",style:{width:P.width,flex:P.width?"none":1,...P.cellStyle},children:P.render(Z,D.index)},P.key))},D.key)})})})]})}function Pe(){const z=(r,o,g)=>{const c=r.target.value===""?(g==null?void 0:g.fallback)??0:Number(r.target.value);if(r.target.value!==""&&(isNaN(c)||(g==null?void 0:g.min)!==void 0&&c<g.min||(g==null?void 0:g.max)!==void 0&&c>g.max)){U("Î Î±ÏÎ±ÎºÎ±Î»ÏŽ ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ Î­Î³ÎºÏ…ÏÎ¿ Î±ÏÎ¹Î¸Î¼ÏŒ","warning"),o((g==null?void 0:g.fallback)??0);return}o(c)},{ingredients:Y,loading:ae,error:k,createIngredient:re,updateIngredient:oe,deleteIngredient:se,refresh:X}=ve(),{showToast:U,showConfirm:u}=Ne(),{recordDelete:Q,recordUpdate:D}=Ce(),[Z,ee]=J.useState(!1),[P,he]=J.useState(null),[V,ue]=J.useState(""),[ce,me]=J.useState(""),[R,G]=J.useState({name:"",category:"Î†Î»Î»Î±",unit:"kg",price:0,waste_percent:0,supplier:"",notes:""}),[te,v]=J.useState(null),[e,t]=J.useState([]),[i,a]=J.useState(null),[n,p]=J.useState(!1),S=J.useMemo(()=>Y.filter(r=>{const o=V===""||r.name.toLowerCase().includes(V.toLowerCase())||r.supplier&&r.supplier.toLowerCase().includes(V.toLowerCase()),g=ce===""||r.category===ce;return o&&g}),[Y,V,ce]),{currentPageData:H,currentPage:q,totalPages:_,pageSize:N,pageSizeOptions:d,rangeDisplay:L,isFirstPage:f,isLastPage:y,goToPage:l,setPageSize:O}=Re(S,{initialPageSize:20,pageSizeOptions:[10,20,50,100]}),{shouldVirtualize:I}=Fe(S.length),T=[{key:"name",header:"ÎŒÎ½Î¿Î¼Î±",render:r=>r.name},{key:"category",header:"ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±",render:r=>r.category},{key:"price",header:"Î¤Î¹Î¼Î®",render:r=>`${r.price.toFixed(2)} â‚¬`},{key:"unit",header:"ÎœÎ¿Î½Î¬Î´Î±",render:r=>r.unit},{key:"waste_percent",header:"Î‘Ï€ÏŽÎ»ÎµÎ¹Î±",render:r=>`${r.waste_percent}%`},{key:"supplier",header:"Î ÏÎ¿Î¼Î·Î¸ÎµÏ…Ï„Î®Ï‚",render:r=>r.supplier||"-"},{key:"actions",header:"Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚",render:r=>s.jsxs("div",{className:"action-buttons",children:[s.jsx("button",{className:"btn-icon history",onClick:()=>C(r),title:"Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î¤Î¹Î¼ÏŽÎ½",children:"ðŸ“ˆ"}),s.jsx("button",{className:"btn-icon edit",onClick:()=>x(r),children:"âœï¸"}),s.jsx("button",{className:"btn-icon delete",onClick:()=>b(r.id),children:"ðŸ—‘ï¸"})]}),cellStyle:{minWidth:120}}],W=[...new Set(Y.map(r=>r.category))].sort(),m=()=>{G({name:"",category:"Î†Î»Î»Î±",unit:"kg",price:0,waste_percent:0,supplier:"",notes:""}),he(null),ee(!1)},x=r=>{G({id:r.id,name:r.name,category:r.category,unit:r.unit,price:r.price,waste_percent:r.waste_percent,supplier:r.supplier||"",notes:r.notes||""}),he(r.id),ee(!0)},C=async r=>{v(r),p(!0);try{const{getPriceHistory:o,getPriceStats:g}=await ke(async()=>{const{getPriceHistory:$,getPriceStats:E}=await import("./tauri-vzOShXsj.js");return{getPriceHistory:$,getPriceStats:E}},[]),[c,j]=await Promise.all([o(r.id),g(r.id)]);t(c),a(j)}catch(o){U(`Î£Ï†Î¬Î»Î¼Î±: ${o}`,"error")}finally{p(!1)}},h=async r=>{if(r.preventDefault(),typeof R.waste_percent=="number"&&(R.waste_percent<0||R.waste_percent>100)){U('Î¤Î¿ Ï€ÎµÎ´Î¯Î¿ "Î‘Ï€ÏŽÎ»ÎµÎ¹Î± %" Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ Î¼ÎµÏ„Î±Î¾Ï 0 ÎºÎ±Î¹ 100.',"warning");return}try{if(P){const o=Y.find(g=>g.id===P);o&&D("ingredient",o,o.name),await oe({...R,id:P}),U("Î¤Î¿ Ï…Î»Î¹ÎºÏŒ ÎµÎ½Î·Î¼ÎµÏÏŽÎ¸Î·ÎºÎµ","success")}else await re(R),U("Î¤Î¿ Ï…Î»Î¹ÎºÏŒ Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î®Î¸Î·ÎºÎµ","success");m()}catch(o){U(`Î£Ï†Î¬Î»Î¼Î±: ${o}`,"error")}},w=J.useRef(null),F=r=>{var g;const o=(g=r.target.files)==null?void 0:g[0];o&&(Te.parse(o,{header:!0,skipEmptyLines:!0,complete:async c=>{let j=0,$=0;for(const E of c.data)try{if(!E.Name&&!E.name)continue;const B={name:E.Name||E.name,category:E.Category||E.category||"Î†Î»Î»Î±",price:parseFloat(E.Price||E.price||"0"),unit:E.Unit||E.unit||"kg",waste_percent:parseFloat(E.Waste||E.waste||"0"),supplier:E.Supplier||E.supplier||"",notes:E.Notes||E.notes||""};await re(B),j++}catch(B){console.error("Error importing row:",E,B),$++}U(`Î•Î¹ÏƒÎ®Ï‡Î¸Î·ÏƒÎ±Î½ ${j} Ï…Î»Î¹ÎºÎ¬. ${$>0?`${$} ÏƒÏ†Î¬Î»Î¼Î±Ï„Î±.`:""}`,$>0?"warning":"success"),X()},error:c=>{U(`Î£Ï†Î¬Î»Î¼Î± Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·Ï‚ CSV: ${c.message}`,"error")}}),w.current&&(w.current.value=""))},b=async r=>{const o=Y.find(g=>g.id===r);o&&u(`Î”Î¹Î±Î³ÏÎ±Ï†Î® "${o.name}";`,async()=>{try{Q("ingredient",o,o.name),await se(r),U("Î¤Î¿ Ï…Î»Î¹ÎºÏŒ Î´Î¹Î±Î³ÏÎ¬Ï†Î·ÎºÎµ","success")}catch(g){U(`Î£Ï†Î¬Î»Î¼Î±: ${g}`,"error")}})};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"toolbar",children:[s.jsx("button",{className:"btn-primary",onClick:()=>{m(),ee(!Z)},children:Z?"âœ• ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿":"+ ÎÎ­Î¿ Î¥Î»Î¹ÎºÏŒ"}),s.jsx("input",{type:"file",ref:w,style:{display:"none"},accept:".csv",onChange:F}),s.jsx("button",{className:"btn-secondary",onClick:()=>{var r;return(r=w.current)==null?void 0:r.click()},children:"ðŸ“‚ Import CSV"}),s.jsx("button",{className:"btn-secondary",onClick:X,children:"ðŸ”„"})]}),s.jsxs("div",{className:"search-bar",children:[s.jsxs("div",{className:"search-input-wrapper",children:[s.jsx("span",{className:"search-icon",children:"ðŸ”"}),s.jsx("input",{type:"text",placeholder:"Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Ï…Î»Î¹ÎºÎ¿Ï Î® Ï€ÏÎ¿Î¼Î·Î¸ÎµÏ…Ï„Î®...",value:V,onChange:r=>ue(r.target.value),className:"search-input"}),V&&s.jsx("button",{className:"btn-icon clear-search",onClick:()=>ue(""),children:"âœ•"})]}),s.jsxs("select",{value:ce,onChange:r=>me(r.target.value),className:"filter-select",children:[s.jsx("option",{value:"",children:"ÎŒÎ»ÎµÏ‚ Î¿Î¹ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚"}),W.map(r=>s.jsx("option",{value:r,children:r},r))]}),s.jsxs("span",{className:"results-count",children:[S.length," / ",Y.length]})]}),Z&&s.jsxs("form",{onSubmit:h,className:"form",children:[s.jsx("h3",{className:"form-title",children:P?"âœï¸ Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± Î¥Î»Î¹ÎºÎ¿Ï":"âž• ÎÎ­Î¿ Î¥Î»Î¹ÎºÏŒ"}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",style:{flex:2},children:[s.jsx("label",{htmlFor:"ing-name",children:"ÎŒÎ½Î¿Î¼Î±:"}),s.jsx("input",{id:"ing-name",type:"text",value:R.name,onChange:r=>G({...R,name:r.target.value}),required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±:"}),s.jsx("select",{value:R.category,onChange:r=>G({...R,category:r.target.value}),children:be.map(r=>s.jsx("option",{value:r,children:r},r))})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{htmlFor:"ing-price",children:"Î¤Î¹Î¼Î® (â‚¬):"}),s.jsx("input",{id:"ing-price",type:"number",step:"0.01",min:"0",value:R.price,onChange:r=>z(r,o=>G({...R,price:o}),{min:0,fallback:0})})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"ÎœÎ¿Î½Î¬Î´Î±:"}),s.jsx("select",{value:R.unit,onChange:r=>G({...R,unit:r.target.value}),children:je.map(r=>s.jsx("option",{value:r,children:r},r))})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Î‘Ï€ÏŽÎ»ÎµÎ¹Î± %:"}),s.jsx("input",{type:"number",step:"1",min:"0",max:"100",value:R.waste_percent,onChange:r=>z(r,o=>G({...R,waste_percent:o}),{min:0,max:100,fallback:0})})]})]}),s.jsxs("div",{className:"form-row",children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Î ÏÎ¿Î¼Î·Î¸ÎµÏ…Ï„Î®Ï‚:"}),s.jsx("input",{type:"text",value:R.supplier||"",onChange:r=>G({...R,supplier:r.target.value})})]}),s.jsxs("div",{className:"form-group",style:{flex:2},children:[s.jsx("label",{children:"Î£Î·Î¼ÎµÎ¹ÏŽÏƒÎµÎ¹Ï‚:"}),s.jsx("input",{type:"text",value:R.notes||"",onChange:r=>G({...R,notes:r.target.value})})]})]}),s.jsxs("div",{className:"form-actions",children:[s.jsx("button",{type:"submit",className:"btn-primary",children:P?"ðŸ’¾ Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·":"ðŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·"}),P&&s.jsx("button",{type:"button",className:"btn-secondary",onClick:m,children:"Î‘ÎºÏÏÏ‰ÏƒÎ·"})]})]}),ae&&s.jsx(Ee,{count:8}),k&&s.jsxs("p",{className:"error",children:["Î£Ï†Î¬Î»Î¼Î±: ",k]}),I?s.jsx(Ae,{items:S,columns:T,rowHeight:48,headerHeight:48,className:"virtual-table-ingredients"}):s.jsxs("div",{className:"ingredients-grid grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[H.map(r=>s.jsx(Le,{ingredient:r,onEdit:x,onDelete:b},r.id)),S.length===0&&!ae&&s.jsx("div",{className:"no-data col-span-full",children:V||ce?"Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ Ï…Î»Î¹ÎºÎ¬ Î¼Îµ Î±Ï…Ï„Î¬ Ï„Î± ÎºÏÎ¹Ï„Î®ÏÎ¹Î±":"Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï…Î»Î¹ÎºÎ¬. Î ÏÎ¿ÏƒÎ¸Î­ÏƒÏ„Îµ Ï„Î¿ Ï€ÏÏŽÏ„Î¿!"})]}),S.length>0&&s.jsx(Ie,{currentPage:q,totalPages:_,pageSize:N,pageSizeOptions:d,rangeDisplay:L,isFirstPage:f,isLastPage:y,onPageChange:l,onPageSizeChange:O}),te&&s.jsx("div",{className:"modal-overlay",onClick:()=>v(null),children:s.jsxs("div",{className:"modal price-history-modal",onClick:r=>r.stopPropagation(),children:[s.jsx("h3",{children:"ðŸ“ˆ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î¤Î¹Î¼ÏŽÎ½"}),s.jsx("p",{className:"modal-subtitle",children:te.name}),n?s.jsx("div",{className:"loading",children:"Î¦ÏŒÏÏ„Ï‰ÏƒÎ·..."}):s.jsxs(s.Fragment,{children:[i&&i.record_count>0&&s.jsxs("div",{className:"price-stats-grid",children:[s.jsxs("div",{className:"price-stat",children:[s.jsx("span",{className:"stat-label",children:"Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ±"}),s.jsxs("span",{className:"stat-value current",children:[i.current_price.toFixed(2)," â‚¬"]}),i.previous_price&&s.jsxs("span",{className:`stat-change ${i.current_price>i.previous_price?"up":"down"}`,children:[i.current_price>i.previous_price?"â–²":"â–¼",Math.abs((i.current_price-i.previous_price)/i.previous_price*100).toFixed(1),"%"]})]}),s.jsxs("div",{className:"price-stat",children:[s.jsx("span",{className:"stat-label",children:"Î•Î»Î¬Ï‡Î¹ÏƒÏ„Î·"}),s.jsxs("span",{className:"stat-value min",children:[i.min_price.toFixed(2)," â‚¬"]})]}),s.jsxs("div",{className:"price-stat",children:[s.jsx("span",{className:"stat-label",children:"ÎœÎ­Î³Î¹ÏƒÏ„Î·"}),s.jsxs("span",{className:"stat-value max",children:[i.max_price.toFixed(2)," â‚¬"]})]}),s.jsxs("div",{className:"price-stat",children:[s.jsx("span",{className:"stat-label",children:"ÎœÎ­ÏƒÎ·"}),s.jsxs("span",{className:"stat-value avg",children:[i.avg_price.toFixed(2)," â‚¬"]})]})]}),e.length>0?s.jsxs("div",{className:"price-history-list",children:[s.jsxs("div",{className:"history-header",children:[s.jsx("span",{children:"Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±"}),s.jsx("span",{children:"Î¤Î¹Î¼Î®"}),s.jsx("span",{children:"Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·"})]}),e.map(r=>s.jsxs("div",{className:"history-row",children:[s.jsx("span",{className:"history-date",children:r.recorded_at?new Date(r.recorded_at).toLocaleDateString("el-GR"):"-"}),s.jsxs("span",{className:"history-price",children:[r.price.toFixed(2)," â‚¬"]}),s.jsx("span",{className:"history-notes",children:r.notes||"-"})]},r.id))]}):s.jsxs("div",{className:"empty-history",children:[s.jsx("p",{children:"Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Ï„Î¹Î¼ÏŽÎ½"}),s.jsx("p",{className:"hint",children:"ÎŸÎ¹ Ï„Î¹Î¼Î­Ï‚ ÎºÎ±Ï„Î±Î³ÏÎ¬Ï†Î¿Î½Ï„Î±Î¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± ÏŒÏ„Î±Î½ ÎµÎ½Î·Î¼ÎµÏÏŽÎ½ÎµÎ¹Ï‚ Ï„Î¿ Ï…Î»Î¹ÎºÏŒ"})]})]}),s.jsx("div",{className:"modal-actions",children:s.jsx("button",{className:"btn-secondary",onClick:()=>v(null),children:"ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿"})})]})})]})}const Be=J.memo(Pe);export{Be as default};
